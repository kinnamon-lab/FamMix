<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Changelog • FamModel</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Changelog" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-news">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamModel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/linear_mixed_models.html">Linear Mixed Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kinnamon-lab/FamModel/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <h1 data-toc-skip>Changelog <small></small></h1>
      <small>Source: <a href='https://github.com/kinnamon-lab/FamModel/blob/master/NEWS.md'><code>NEWS.md</code></a></small>
    </div>

    <div id="fammodel-100" class="section level1">
<h1 class="page-header" data-toc-text="1.0.0">
<a href="#fammodel-100" class="anchor"></a>FamModel 1.0.0</h1>
<div id="r-code-changes-and-improvements" class="section level2">
<h2 class="hasAnchor">
<a href="#r-code-changes-and-improvements" class="anchor"></a>R code changes and improvements</h2>
<div id="contrast-class" class="section level3">
<h3 class="hasAnchor">
<a href="#contrast-class" class="anchor"></a><code>Contrast</code> class</h3>
<ul>
<li>Changed to store estimate of <span class="math inline"><em>L</em><em>θ</em> − <em>m</em></span> rather than <span class="math inline"><em>L</em><em>θ</em></span>.</li>
<li>Changed chi-square df calculation to use rank of <span class="math inline"><em>L</em></span> rather than number of rows.</li>
<li>Improved output from <code>print</code> method.</li>
</ul>
</div>
<div id="famdata-class" class="section level3">
<h3 class="hasAnchor">
<a href="#famdata-class" class="anchor"></a><code>FamData</code> class</h3>
<ul>
<li>Added checks to constructor to make sure that individual order and identifiers are identical in <code>data</code> and <code>phi</code> members.</li>
<li>Added pedigree check to constructor.</li>
<li>Converted all integer storage type numeric columns in input data set to double storage type to avoid later comparison errors with <code><a href="https://rdrr.io/r/base/identical.html">identical()</a></code>.</li>
<li>Added identification of families with consanguinity and <code>get_consang</code> method.</li>
<li>Modified <code>get_data</code> method to return copy of <code>data</code> member to avoid inadvertent modification by reference.</li>
<li>Added <code>print</code> method.</li>
<li>Modified <code>make_model_mats_lmm</code> to track included observations from data member by <code>fmid</code> and <code>id</code> and include these identifiers as names or row names to increase robustness.</li>
<li>Modified <code>lmm</code> method to use only non-probands in <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> fit used to obtain initial parameter estimates for optimization.</li>
</ul>
</div>
<div id="famlmmfit-subclass" class="section level3">
<h3 class="hasAnchor">
<a href="#famlmmfit-subclass" class="anchor"></a><code>FamLMMFit</code> subclass</h3>
<ul>
<li>Disallowed construction outside of internal <code>FamModel</code> methods and functions.</li>
<li>Made sure that analytical, not numeric, Hessian was being used in covariance matrix calculation.</li>
<li>Added data mapping checks to constructor to protect against bugs due to future API changes and ensure accurate diagnostic output.</li>
<li>Added <code>get_model_res</code> method with additional diagnostic features.</li>
<li>Added scaled gradient convergence criterion and negative Hessian diagnostics to <code>print</code> and <code>get_h2_a_lrts</code> methods.</li>
<li>Modified <code>get_h2_a_lrts</code> to cache heritability LRT results after first call and use cached values on subsequent calls unless the user explicitly overrides.</li>
</ul>
</div>
<div id="other" class="section level3">
<h3 class="hasAnchor">
<a href="#other" class="anchor"></a>Other</h3>
<ul>
<li>Moved common LMM optimization code to utility function and switched optimization to use <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> without relative function convergence criterion.</li>
<li>Switched from variance to SD paramaterization for linear mixed model to improve scaling properties of optimization problem.</li>
<li>Added rigorous argument checks to <code><a href="../reference/make_coef_mat.html">make_coef_mat()</a></code> and <code><a href="../reference/print_ests.html">print_ests()</a></code>.</li>
<li>Added title argument to <code><a href="../reference/print_ests.html">print_ests()</a></code>.</li>
<li>Replaced <code><a href="https://rdrr.io/r/base/all.equal.html">all.equal()</a></code> with <code><a href="https://rdrr.io/r/base/identical.html">identical()</a></code> for all object comparisons where floating point imprecision should not be an issue.</li>
</ul>
</div>
</div>
<div id="c-template-infrastructure-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#c-template-infrastructure-changes" class="anchor"></a>C++ template infrastructure changes</h2>
<ul>
<li>Fixed bug in <code>sing_asc_lmm</code> model that would yield misspecified trait variance for inbred individuals.</li>
<li>Moved diagnostic calculations, which are not necessary for optimization, to <code>FamLMMFit$get_model_res()</code> method to speed up iterations.</li>
<li>Transitioned to shared library with same name as package to avoid issues with newer <code>pkgload</code> versions during development.</li>
<li>Refactored to allow easy incorporation of multiple models into a single shared library as per <a href="https://github.com/mlysy/TMBtools" class="uri">https://github.com/mlysy/TMBtools</a>.</li>
</ul>
</div>
<div id="documentation-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#documentation-changes" class="anchor"></a>Documentation changes</h2>
<ul>
<li>Added <code><a href="../articles/linear_mixed_models.html">vignette("linear_mixed_models")</a></code>.
<ul>
<li>Moved methodological details from individual class and method documentation to vignette.</li>
<li>Discussed conditions required for valid inferences when true values fall on boundaries of the parameter space.</li>
<li>Discussed properties of estimated residuals and diagnostics relevant to assessing goodness of fit.</li>
</ul>
</li>
</ul>
</div>
</div>
    <div id="fammodel-020" class="section level1">
<h1 class="page-header" data-toc-text="0.2.0">
<a href="#fammodel-020" class="anchor"></a>FamModel 0.2.0</h1>
<div id="major-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#major-changes" class="anchor"></a>Major Changes</h2>
<ul>
<li>Renamed package to FamModel.</li>
<li>Added new classes for working with model results:
<ul>
<li>
<code>FamModelFit</code> abstract class.</li>
<li>
<code>FamLMMFit</code> subclass specialized for linear mixed model results.</li>
<li>
<code>Contrast</code> class for results of general contrasts for a <code>FamModelFit</code> object.</li>
</ul>
</li>
<li>Modified linear mixed modeling framework to allow:
<ul>
<li>Variance component heterogeneity across families from different populations.</li>
<li>Return of various types of residuals.</li>
</ul>
</li>
<li>Added utility functions for printing coefficient matrices.</li>
<li>Made various other improvements for robustness.</li>
<li>Updated and expanded documentation with additional methodological details and references.</li>
</ul>
</div>
</div>
    <div id="fammix-013" class="section level1">
<h1 class="page-header" data-toc-text="0.1.3">
<a href="#fammix-013" class="anchor"></a>FamMix 0.1.3</h1>
<div id="minor-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#minor-changes" class="anchor"></a>Minor Changes</h2>
<ul>
<li>Modified <code>FamData$lmm()</code> method by adding code to transform likelihood maximization problem by scaling parameters by square root of their Hessian diagonal elements at the initial estimates, which should improve conditioning of the Hessian and therefore numerical convergence.</li>
</ul>
</div>
</div>
    <div id="fammix-012" class="section level1">
<h1 class="page-header" data-toc-text="0.1.2">
<a href="#fammix-012" class="anchor"></a>FamMix 0.1.2</h1>
<div id="minor-changes-1" class="section level2">
<h2 class="hasAnchor">
<a href="#minor-changes-1" class="anchor"></a>Minor Changes</h2>
<ul>
<li>Changed <code>FamData</code> constructors to use character string column names and updated documentation.</li>
</ul>
</div>
</div>
    <div id="fammix-011" class="section level1">
<h1 class="page-header" data-toc-text="0.1.1">
<a href="#fammix-011" class="anchor"></a>FamMix 0.1.1</h1>
<div id="bug-fixes" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes" class="anchor"></a>Bug Fixes</h2>
<ul>
<li>Fixed bug in <code>FamData$new()</code> using <code>phi</code> signature.</li>
</ul>
</div>
</div>
    <div id="fammix-010" class="section level1">
<h1 class="page-header" data-toc-text="0.1.0">
<a href="#fammix-010" class="anchor"></a>FamMix 0.1.0</h1>
<ul>
<li>Initial release.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel D. Kinnamon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


