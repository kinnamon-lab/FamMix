<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Regression Modeling for Family-Based Genetic Studies • FamModel</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Regression Modeling for Family-Based Genetic Studies">
<meta property="og:description" content="This package implements regression models for family-based genetic
    studies, including mixed models. While such models can be fit with other
    existing software, this package tries to provide a unified solution that
    leverages the flexibility of the R environment. It also leverages modern
    automatic differentiation techniques to fit likelihood-based models
    quickly.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">FamModel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/linear_mixed_models.html">Linear Mixed Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="fammodel" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#fammodel" class="anchor"></a>FamModel</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>This package implements regression models for family-based genetic studies, including mixed models. While such models can be fit with other existing software, this package tries to provide a unified solution that leverages the flexibility of the R environment. It also leverages modern automatic differentiation techniques to fit likelihood-based models quickly.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the latest released version of FamModel from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"kinnamon-lab/FamModel"</span>, ref <span class="op">=</span> <span class="st">"[tag]"</span><span class="op">)</span></code></pre></div>
<p>where <code>[tag]</code> is the tag of the most recent release.</p>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>The following code fits a univariate version of the linear mixed model presented in <a href="https://doi.org/10.1161/CIRCGEN.117.002038">Cowan et al. (2018)</a> with an equivalent parameterization using the <code>lmna_nonseg</code> example data provided with the package. Note how the package permits flexible use of <code>formula</code> constructs and provides an appropriate likelihood ratio test for a null narrow-sense heritability on the boundary of the parameter space.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lmna_data</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="va">lmna_nonseg</span><span class="op">)</span><span class="op">[</span>,
  <span class="fu">`:=`</span><span class="op">(</span>
    female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>,
    age_echo_std <span class="op">=</span> <span class="op">(</span><span class="va">age_echo_yrs</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age_echo_yrs</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">age_echo_yrs</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="op">)</span>
<span class="op">]</span>
<span class="va">lmna_fd</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/FamData.html">FamData</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>
  <span class="va">lmna_data</span>,
  family_id <span class="op">=</span> <span class="st">"family_ID"</span>,
  indiv_id <span class="op">=</span> <span class="st">"individual_ID"</span>,
  proband <span class="op">=</span> <span class="st">"proband"</span>,
  sex <span class="op">=</span> <span class="st">"sex"</span>,
  maternal_id <span class="op">=</span> <span class="st">"maternal_ID"</span>,
  paternal_id <span class="op">=</span> <span class="st">"paternal_ID"</span>,
  mzgrp <span class="op">=</span> <span class="st">"mzpair"</span>,
  dzgrp <span class="op">=</span> <span class="st">"dzpair"</span>
<span class="op">)</span>
<span class="va">lmna_lvef_model</span> <span class="op">&lt;-</span> <span class="va">lmna_fd</span><span class="op">$</span><span class="fu">lmm</span><span class="op">(</span>
  <span class="va">lvef</span> <span class="op">~</span> <span class="va">age_echo_std</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">n_lmna_vars</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">n_oth_vars</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">lmna_lvef_model</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="op">==</span><span class="er">=</span>LINEAR MIXED MODEL RESULTS<span class="op">==</span><span class="er">=</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>DATA<span class="op">:</span><span class="st"> </span>lmna_data</span>
<span id="cb3-3"><a href="#cb3-3"></a>MEAN MODEL<span class="op">:</span><span class="st"> </span>lvef <span class="op">~</span><span class="st"> </span>age_echo_std <span class="op">+</span><span class="st"> </span>female <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(n_lmna_vars <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(n_oth_vars <span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="st">    </span><span class="dv">0</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>VARIANCE PARAMETER GROUPS<span class="op">:</span><span class="st"> </span><span class="er">~</span><span class="dv">1</span></span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a>FAMILIES USED<span class="op">:</span><span class="st"> </span><span class="dv">5</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>SUBJECTS USED<span class="op">:</span><span class="st"> </span><span class="dv">36</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>PROBANDS<span class="op">:</span><span class="st"> </span><span class="dv">5</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>FAMILY SIZE DISTRIBUTION<span class="op">:</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="st"> </span><span class="dv">2</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">19</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>         </span>
<span id="cb3-13"><a href="#cb3-13"></a> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span>  <span class="dv">1</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>CONVERGENCE ACHIEVED AT <span class="dv">-2</span> LL =<span class="st"> </span><span class="fl">251.2582</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>EVALUATIONS<span class="op">:</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="cf">function</span> gradient </span>
<span id="cb3-17"><a href="#cb3-17"></a>      <span class="dv">22</span>       <span class="dv">22</span> </span>
<span id="cb3-18"><a href="#cb3-18"></a>MESSAGE<span class="op">:</span><span class="st"> </span>CONVERGENCE<span class="op">:</span><span class="st"> </span>NORM OF PROJECTED GRADIENT <span class="op">&lt;=</span><span class="st"> </span>PGTOL</span>
<span id="cb3-19"><a href="#cb3-19"></a>MAX ABSOLUTE ELEMENT OF LL <span class="kw">GRADIENT</span> (g) AT SOLUTION<span class="op">:</span><span class="st"> </span><span class="fl">2.111348e-06</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>NEGATIVE LL <span class="kw">HESSIAN</span> (<span class="op">-</span>H) CHARACTERISTICS AT SOLUTION<span class="op">:</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="st">   </span>SMALLEST EIGENVALUE<span class="op">:</span><span class="st"> </span><span class="fl">2.071145e-02</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>   RECIPROCAL CONDITION NUMBER<span class="op">:</span><span class="st"> </span><span class="fl">2.204369e-03</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>SCALED LL <span class="kw">GRADIENT</span> (<span class="op">-</span>g<span class="st">' * H^-1 * g) CRITERION AT SOLUTION: 5.39971e-12</span></span>
<span id="cb3-24"><a href="#cb3-24"></a></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="st">VARIANCE PARAMETERS</span></span>
<span id="cb3-26"><a href="#cb3-26"></a></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="st">Parameter Estimates</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="st">-------------------</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="st">      Estimate       SE</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="st">h2_a   0.35479  0.59385</span></span>
<span id="cb3-31"><a href="#cb3-31"></a><span class="st">sigma 14.23753  2.05032</span></span>
<span id="cb3-32"><a href="#cb3-32"></a></span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="st">Likelihood Ratio Tests</span></span>
<span id="cb3-34"><a href="#cb3-34"></a><span class="st">----------------------</span></span>
<span id="cb3-35"><a href="#cb3-35"></a><span class="st">       Ho      Max |g| -g'</span> <span class="op">*</span><span class="st"> </span>H<span class="op">^-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>g Min <span class="kw">lambda</span>(<span class="op">-</span>H) <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">kappa</span>(<span class="op">-</span>H)  LR X<span class="op">^</span><span class="dv">2</span> <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="st"> </span>X<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb3-36"><a href="#cb3-36"></a> <span class="dt">h2_a =</span> <span class="dv">0</span> <span class="fl">1.788213e-08</span>   <span class="fl">1.015742e-15</span>   <span class="fl">2.038056e-02</span>  <span class="fl">6.473824e-02</span> <span class="fl">0.48601</span>   <span class="fl">0.24286</span></span>
<span id="cb3-37"><a href="#cb3-37"></a></span>
<span id="cb3-38"><a href="#cb3-38"></a>MEAN MODEL</span>
<span id="cb3-39"><a href="#cb3-39"></a></span>
<span id="cb3-40"><a href="#cb3-40"></a>Parameter Estimates</span>
<span id="cb3-41"><a href="#cb3-41"></a><span class="op">-------------------</span></span>
<span id="cb3-42"><a href="#cb3-42"></a><span class="st">                        </span>Estimate        SE   <span class="dv">95</span><span class="op">% LCL   95%</span><span class="st"> </span>UCL Z value  <span class="kw">Pr</span>(<span class="op">&gt;</span><span class="er">|</span>Z<span class="op">|</span>)    </span>
<span id="cb3-43"><a href="#cb3-43"></a>(Intercept)             <span class="fl">50.64295</span>   <span class="fl">5.90382</span>  <span class="fl">39.07168</span>  <span class="fl">62.21423</span>  <span class="fl">8.5780</span> <span class="op">&lt;</span><span class="st"> </span><span class="fl">2.2e-16</span> <span class="op">**</span><span class="er">*</span></span>
<span id="cb3-44"><a href="#cb3-44"></a>age_echo_std            <span class="fl">-5.75982</span>   <span class="fl">3.17743</span> <span class="fl">-11.98747</span>   <span class="fl">0.46782</span> <span class="fl">-1.8127</span>  <span class="fl">0.069873</span> .  </span>
<span id="cb3-45"><a href="#cb3-45"></a>female                   <span class="fl">3.40805</span>   <span class="fl">5.29036</span>  <span class="fl">-6.96087</span>  <span class="fl">13.77697</span>  <span class="fl">0.6442</span>  <span class="fl">0.519446</span>    </span>
<span id="cb3-46"><a href="#cb3-46"></a><span class="kw">I</span>(n_lmna_vars <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)<span class="ot">TRUE</span>   <span class="fl">3.38145</span>   <span class="fl">5.73934</span>  <span class="fl">-7.86745</span>  <span class="fl">14.63035</span>  <span class="fl">0.5892</span>  <span class="fl">0.555747</span>    </span>
<span id="cb3-47"><a href="#cb3-47"></a><span class="kw">I</span>(n_oth_vars <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)<span class="ot">TRUE</span>  <span class="fl">-13.31168</span>   <span class="fl">5.15733</span> <span class="fl">-23.41986</span>  <span class="fl">-3.20351</span> <span class="fl">-2.5811</span>  <span class="fl">0.009848</span> <span class="op">**</span><span class="st"> </span></span>
<span id="cb3-48"><a href="#cb3-48"></a><span class="op">---</span></span>
<span id="cb3-49"><a href="#cb3-49"></a>Signif. codes<span class="op">:</span><span class="st">  </span><span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span>
<span id="cb3-50"><a href="#cb3-50"></a></span>
<span id="cb3-51"><a href="#cb3-51"></a>NOTE<span class="op">:</span><span class="st"> </span>Wald tests and CIs are displayed <span class="cf">in</span> the above output</span></code></pre></div>
</div>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>Development of this software was supported by the National Heart, Lung, and Blood Institute and National Human Genome Research Institute of the National Institutes of Health under award numbers R01HL128857 and R01HL149423. The content is solely the responsibility of the author and does not necessarily represent the official views of the National Institutes of Health.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Daniel D. Kinnamon <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0867-5227" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Daniel D. Kinnamon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
