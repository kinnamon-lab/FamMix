<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Family data for modeling — FamData • FamModel</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Family data for modeling — FamData" />
<meta property="og:description" content="An R6 class that stores family data and a kinship matrix." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamModel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/linear_mixed_models.html">Linear Mixed Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kinnamon-lab/FamModel/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Family data for modeling</h1>
    <small class="dont-index">Source: <a href='https://github.com/kinnamon-lab/FamModel/blob/master/R/FamData.R'><code>R/FamData.R</code></a></small>
    <div class="hidden name"><code>FamData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An R6 class that stores family data and a kinship matrix.</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Methods of this class can be used to fit regression models such as
polygenic mixed models. The class currently supports only family data with
one observation per subject and will check that this requirement is met.</p>
<p>Note that the private <code>data</code> member of the instance (returned by the
<a href='#method-get_data'><code>FamData$get_data()</code></a> method) will always be sorted by
ascending <code>family_id</code> and ascending <code>indiv_id</code> within <code>family_id</code>
regardless of the sort order of the input data set. Also, pedigree columns
in the input data set will be renamed in the <code>data</code> member; this mapping
can be returned using the <a href='#method-get_var_map'><code>FamData$get_var_map()</code></a>
method.</p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Public methods</h3>

<ul>
<li><p><a href='#method-new'><code>FamData$new()</code></a></p></li>
<li><p><a href='#method-get_data'><code>FamData$get_data()</code></a></p></li>
<li><p><a href='#method-get_data_name'><code>FamData$get_data_name()</code></a></p></li>
<li><p><a href='#method-get_consang'><code>FamData$get_consang()</code></a></p></li>
<li><p><a href='#method-get_phi'><code>FamData$get_phi()</code></a></p></li>
<li><p><a href='#method-get_var_map'><code>FamData$get_var_map()</code></a></p></li>
<li><p><a href='#method-print'><code>FamData$print()</code></a></p></li>
<li><p><a href='#method-lmm'><code>FamData$lmm()</code></a></p></li>
<li><p><a href='#method-plot_pedigree'><code>FamData$plot_pedigree()</code></a></p></li>
<li><p><a href='#method-clone'><code>FamData$clone()</code></a></p></li>
</ul>
<p><hr>
<a id="method-new"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>new()</code></h3>
<p>Constructs a new instance of this class.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>...</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>data</code></dt><dd><p>A <code>data.frame</code> or <code>data.table</code> containing all
phenotypes and genetic variables of interest.</p></dd>

<dt><code>...</code></dt><dd><p>The arguments required for a particular method signature;
see below for detailed descriptions.</p></dd>

<dt><code>family_id</code></dt><dd><p>Character string containing the name of a numeric or
character column in <code>data</code> containing a family identifier.</p></dd>

<dt><code>indiv_id</code></dt><dd><p>Character string containing the name of a numeric or
character column in <code>data</code> containing a individual identifier.</p></dd>

<dt><code>proband</code></dt><dd><p>Character string containing the name of a numeric column
in <code>data</code> containing 1 for probands and 0 otherwise. <code>NA</code> is  not
permitted.</p></dd>

<dt><code>sex</code></dt><dd><p>Character string containing the name of a numeric column in
<code>data</code> containing the individual's sex (1 = "male", 2 = "female")
or <code>NA</code> if unknown.</p></dd>

<dt><code>maternal_id</code></dt><dd><p>Character string containing the name of a column in
<code>data</code> of the same type as <code>indiv_id</code> containing the <code>indiv_id</code> of the
individual's mother or 0 (numeric), "" (character), or <code>NA</code> if a
founder. See documentation for <code><a href='https://rdrr.io/pkg/kinship2/man/pedigree.html'>kinship2::pedigree</a></code>.</p></dd>

<dt><code>paternal_id</code></dt><dd><p>Character string containing the name of a column in
<code>data</code> of the same type as <code>indiv_id</code> containing the <code>indiv_id</code> of the
individual's father or or 0 (numeric), "" (character), or <code>NA</code> if a
founder. See documentation for <code><a href='https://rdrr.io/pkg/kinship2/man/pedigree.html'>kinship2::pedigree</a></code>.</p></dd>

<dt><code>mzgrp</code></dt><dd><p>Character string containing the name of a numeric,
character, or factor column in <code>data</code> containing the same value for all
members of a monozygotic twin group. <code>NA</code> should be used for all
individuals who are not monozygotic twins.</p></dd>

<dt><code>dzgrp</code></dt><dd><p>Character string containing the name of a numeric,
character, or factor column in <code>data</code> containing the same value for all
members of a dizygotic twin group. <code>NA</code> should be used for all
individuals who are not dizygotic twins.</p></dd>

<dt><code>phi</code></dt><dd><p>A matrix coercible to a <code><a href='https://rdrr.io/pkg/Matrix/man/dsCMatrix-class.html'>Matrix::dsCMatrix</a></code> containing
the pairwise kinship coefficients for individuals. Note that
<code>phi[i, j]</code> must contain the kinship coefficient between the
individuals in <code>data[i, ]</code> and <code>data[j, ]</code>.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Details</h4>
<p>All constructor arguments other than <code>data</code>
<em>must be named</em>. There are two possible constructor signatures:</p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>family_id</span>, <span class='va'>indiv_id</span>, <span class='va'>proband</span>, <span class='va'>sex</span>,
            <span class='va'>maternal_id</span>, <span class='va'>paternal_id</span>, <span class='va'>mzgrp</span>, <span class='va'>dzgrp</span><span class='op'>)</span>

<span class='va'>FamData</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>family_id</span>, <span class='va'>indiv_id</span>, <span class='va'>proband</span>, <span class='va'>phi</span><span class='op'>)</span>
</pre>


<p><hr>
<a id="method-get_data"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>get_data()</code></h3>
<p>Returns a copy of data member (to prevent accidental
modification of data member <code>data.table</code> by reference).</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>get_data</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<p><hr>
<a id="method-get_data_name"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>get_data_name()</code></h3>
<p>Returns name of input <code>data.frame</code> or <code>data.table</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>get_data_name</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<p><hr>
<a id="method-get_consang"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>get_consang()</code></h3>
<p>Returns vector containing family IDs in which consanguinity
was found (based on individual self-kinship coefficient greater than
0.5).</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>get_consang</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<p><hr>
<a id="method-get_phi"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>get_phi()</code></h3>
<p>Returns kinship matrix member.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>get_phi</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<p><hr>
<a id="method-get_var_map"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>get_var_map()</code></h3>
<p>Returns list mapping variable names in input data set in
<code>data</code> argument to those in data member.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>get_var_map</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<p><hr>
<a id="method-print"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code><a href='https://rdrr.io/r/base/print.html'>print()</a></code></h3>
<p>Prints information about contents of <code>FamData</code> objects
with nice formatting.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>print</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<p><hr>
<a id="method-lmm"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>lmm()</code></h3>
<p>Fits a linear mixed model to ascertained families</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>lmm</span><span class='op'>(</span><span class='va'>formula</span>, <span class='va'>...</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>formula</code></dt><dd><p>A <code><a href='https://rdrr.io/pkg/Formula/man/Formula.html'>Formula::Formula()</a></code> object describing the model for a
phenotype. The formula is of the form <code>y ~ mean | group</code>, where <code>y</code>
(required) is the outcome, <code>mean</code> (optional) specifies the mean model
that includes an intercept by default, and <code>| group</code> (optional)
specifies a factor term that can be used assign families to homogeneous
groups with different variance components. Multiple variables can be
combined into a single factor using <code><a href='https://rdrr.io/r/base/Colon.html'>:</a></code>.</p></dd>

<dt><code>...</code></dt><dd><p>Additional parameters to pass to the <code>control</code> list for
<code><a href='https://rdrr.io/r/stats/optim.html'>optim()</a></code> with <code>method = "L-BGFS-B"</code>. Note that <code>parscale</code> and
<code>fnscale</code> cannot be modified.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Details</h4>
<p>See <code><a href='../articles/linear_mixed_models.html'>vignette("linear_mixed_models")</a></code> for background,
implementation details, and references.</p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>Returns a <code><a href='FamLMMFit.html'>FamLMMFit</a></code> object.</p>
<p><hr>
<a id="method-plot_pedigree"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>plot_pedigree()</code></h3>
<p>For objects initialized with pedigree data, allows plotting
of individual pedigrees using <code><a href='https://rdrr.io/pkg/kinship2/man/plot.pedigree.html'>kinship2::plot.pedigree</a></code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>plot_pedigree</span><span class='op'>(</span><span class='va'>famid</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>famid</code></dt><dd><p>Argument matching the value of a single family in the
<code>family_id</code> column used in the constructor.</p></dd>

</dl><p></div></p>
<p><hr>
<a id="method-clone"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>clone()</code></h3>
<p>The objects of this class are cloneable with this method.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamData</span><span class='op'>$</span><span class='fu'>clone</span><span class='op'>(</span>deep <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p></dd>

</dl><p></div></p>



  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel D. Kinnamon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


