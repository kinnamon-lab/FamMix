<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>A FamModelFit subclass specialized for linear mixed models — FamLMMFit • FamModel</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="A FamModelFit subclass specialized for linear mixed models — FamLMMFit" />
<meta property="og:description" content="A specialized subclass of the FamModelFit abstract class for
linear mixed model results. Methods of this subclass can be used to print
model results in a nice format, access model objects, perform inference on
general contrasts, and perform likelihood ratio tests on variance
parameters. Due to reliance on the internal structures of other objects,
the object generator function is not exported, and instances of the
FamLMMFit class can be initizalized only from within functions in the
FamModel namespace." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamModel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/linear_mixed_models.html">Linear Mixed Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kinnamon-lab/FamModel/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A <code>FamModelFit</code> subclass specialized for linear mixed models</h1>
    <small class="dont-index">Source: <a href='https://github.com/kinnamon-lab/FamModel/blob/master/R/FamLMMFit.R'><code>R/FamLMMFit.R</code></a></small>
    <div class="hidden name"><code>FamLMMFit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A specialized subclass of the <code><a href='FamModelFit.html'>FamModelFit</a></code> abstract class for
linear mixed model results. Methods of this subclass can be used to print
model results in a nice format, access model objects, perform inference on
general contrasts, and perform likelihood ratio tests on variance
parameters. Due to reliance on the internal structures of other objects,
the object generator function is not exported, and instances of the
<code>FamLMMFit</code> class can be initizalized <em>only from within functions in the
<code>FamModel</code> namespace</em>.</p>
    </div>



    <h2 class="hasAnchor" id="super-class"><a class="anchor" href="#super-class"></a>Super class</h2>

    <p><code><a href='FamModelFit.html'>FamModel::FamModelFit</a></code> -&gt; <code>FamLMMFit</code></p>
    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Public methods</h3>

<ul>
<li><p><a href='#method-new'><code>FamLMMFit$new()</code></a></p></li>
<li><p><a href='#method-get_formula'><code>FamLMMFit$get_formula()</code></a></p></li>
<li><p><a href='#method-get_model_res'><code>FamLMMFit$get_model_res()</code></a></p></li>
<li><p><a href='#method-get_objfun'><code>FamLMMFit$get_objfun()</code></a></p></li>
<li><p><a href='#method-get_objfun_par_names'><code>FamLMMFit$get_objfun_par_names()</code></a></p></li>
<li><p><a href='#method-print'><code>FamLMMFit$print()</code></a></p></li>
<li><p><a href='#method-get_h2_a_lrts'><code>FamLMMFit$get_h2_a_lrts()</code></a></p></li>
<li><p><a href='#method-clone'><code>FamLMMFit$clone()</code></a></p></li>
</ul>
<p><details open ><summary>Inherited methods</summary>
<ul>
<li><p><span class="pkg-link" data-pkg="FamModel" data-topic="FamModelFit" data-id="contrast"><a href='../../FamModel/html/FamModelFit.html#method-contrast'><code>FamModel::FamModelFit$contrast()</code></a></span></p></li>
<li><p><span class="pkg-link" data-pkg="FamModel" data-topic="FamModelFit" data-id="get_V_theta_hat"><a href='../../FamModel/html/FamModelFit.html#method-get_V_theta_hat'><code>FamModel::FamModelFit$get_V_theta_hat()</code></a></span></p></li>
<li><p><span class="pkg-link" data-pkg="FamModel" data-topic="FamModelFit" data-id="get_data"><a href='../../FamModel/html/FamModelFit.html#method-get_data'><code>FamModel::FamModelFit$get_data()</code></a></span></p></li>
<li><p><span class="pkg-link" data-pkg="FamModel" data-topic="FamModelFit" data-id="get_optres"><a href='../../FamModel/html/FamModelFit.html#method-get_optres'><code>FamModel::FamModelFit$get_optres()</code></a></span></p></li>
<li><p><span class="pkg-link" data-pkg="FamModel" data-topic="FamModelFit" data-id="get_theta_hat"><a href='../../FamModel/html/FamModelFit.html#method-get_theta_hat'><code>FamModel::FamModelFit$get_theta_hat()</code></a></span></p></li>
</ul>
</details>

<hr>
<a id="method-new"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>new()</code></h3>
<p>Constructs a new instance of this class</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamLMMFit</span><span class='op'>$</span><span class='fu'>new</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>formula</span>, <span class='va'>objfun</span>, <span class='va'>optres</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>data</code></dt><dd><p>The <code><a href='FamData.html'>FamData</a></code> object that produced this model
fit.</p></dd>

<dt><code>formula</code></dt><dd><p>The <code><a href='https://rdrr.io/pkg/Formula/man/Formula.html'>Formula::Formula</a></code> object that describes
the model.</p></dd>

<dt><code>objfun</code></dt><dd><p>A <code><a href='https://rdrr.io/pkg/TMB/man/MakeADFun.html'>TMB::MakeADFun()</a></code> object that has already been run
through an optimizer. This object is expected to have a "type"
attribute of "LMM-SA".</p></dd>

<dt><code>optres</code></dt><dd><p>A <code>list</code> from the optimizer function detailing results.
This list is expected to have an attribute "opttype" that contains a
string identifying the function used for optimization.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Details</h4>
<p>Due to their reliance on the internal structures of other
objects, instances of the <code>FamLMMFit</code> class can be initizalized <em>only
from within functions in the <code>FamModel</code> namespace</em>.</p>

<p><hr>
<a id="method-get_formula"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>get_formula()</code></h3>
<p>Returns the <code><a href='https://rdrr.io/pkg/Formula/man/Formula.html'>Formula::Formula</a></code> object used to construct
the instance.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamLMMFit</span><span class='op'>$</span><span class='fu'>get_formula</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<p><hr>
<a id="method-get_model_res"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>get_model_res()</code></h3>
<p>Returns the original data with fitted values, residuals,
and diagnostics.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamLMMFit</span><span class='op'>$</span><span class='fu'>get_model_res</span><span class='op'>(</span>all <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>all</code></dt><dd><p>If <code>FALSE</code> (default), include only observations that
contributed to the model fit. If <code>TRUE</code>, include all observations in
the <code><a href='FamData.html'>FamData</a></code> object <code>data</code> member. This can be useful for
generating a data set to refit the model without certain outliers.
Fitted values, residuals, and diagnostics columns will have <code>NA</code>
values for observations that did not contribute to the model fit.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Details</h4>
<p>See <code><a href='../articles/linear_mixed_models.html'>vignette("linear_mixed_models")</a></code> for a detailed
description of each residual and diagnostic, suggestions for its use,
and relevant references.</p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>A <code>data.table</code> containing the <code>data</code> member of the
<code><a href='FamData.html'>FamData</a></code> object used to fit this model with the following
additional columns (notation defined in
<code><a href='../articles/linear_mixed_models.html'>vignette("linear_mixed_models")</a></code>):</p><ul>
<li><p><code>mu_hat</code>: The fitted population mean, \(\hat{\mu}_{ij}\).</p></li>
<li><p><code>eta_hat</code>: The mean conditional upon the data in the proband,
\(\hat{\eta}_{ij}\). These are defined for family members
(\(j \neq j_i\)) only and are <code>NA</code> in the proband.</p></li>
<li><p><code>r_c_hat</code>: The estimated Cholesky residuals,
\(\hat{r}_{\mathrm{c}, ij}\). These are defined for family members
(\(j \neq j_i\)) only and are <code>NA</code> in the proband.</p></li>
<li><p><code>r_s_hat</code>: The estimated Pearson-type conditional residuals,
\(\hat{r}_{\mathrm{s}, ij}\). These are defined for family members
(\(j \neq j_i\)) only and are <code>NA</code> in the proband.</p></li>
<li><p><code>c_star_hat</code>: Family-level chi-square goodness of fit statistic,
\(\hat{c}^{*}_{i}\). The same value is provided for each family
member.</p></li>
<li><p><code>c_star_hat_df</code>: Degrees of freedom for \(\hat{c}^{*}_{i}\), which
is equal to the number of non-probands in the family. The same value
is provided for each family member.</p></li>
<li><p><code>p_c_star_hat</code>: Probability of obtaining a deviate as or more extreme
than  \(\hat{c}^{*}_{i}\), \(\hat{p}_{\hat{c}^{*}_{i}}\). The
same value is provided for each family member.</p></li>
<li><p><code>r_star_hat</code>: Individual-level goodness of fit statistic,
\(\hat{r}^{*}_{ij}\). These are defined for family members
(\(j \neq j_i\)) only and are <code>NA</code> in the proband.</p></li>
</ul>

<p><hr>
<a id="method-get_objfun"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>get_objfun()</code></h3>
<p>Returns <code><a href='https://rdrr.io/pkg/TMB/man/MakeADFun.html'>TMB::MakeADFun()</a></code> object used to construct the
instance.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamLMMFit</span><span class='op'>$</span><span class='fu'>get_objfun</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<p><hr>
<a id="method-get_objfun_par_names"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>get_objfun_par_names()</code></h3>
<p>Returns a vector of names derived from the original formula
that map to each element of <code>objfun$par</code>.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamLMMFit</span><span class='op'>$</span><span class='fu'>get_objfun_par_names</span><span class='op'>(</span><span class='op'>)</span></pre><p></div></p>

<p><hr>
<a id="method-print"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code><a href='https://rdrr.io/r/base/print.html'>print()</a></code></h3>
<p>Prints contents of <code>FamLMMFit</code> objects with nice formatting.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamLMMFit</span><span class='op'>$</span><span class='fu'>print</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>...</code></dt><dd><p>Arguments passed on to <code><a href='print_ests.html'>print_ests()</a></code>.</p></dd>

</dl><p></div></p>
<p><hr>
<a id="method-get_h2_a_lrts"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>get_h2_a_lrts()</code></h3>
<p>Perform likelihood ratio test(s) for no polygenic effect(s)</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamLMMFit</span><span class='op'>$</span><span class='fu'>get_h2_a_lrts</span><span class='op'>(</span>print <span class='op'>=</span> <span class='cn'>TRUE</span>, use_cached <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>print</code></dt><dd><p>If <code>TRUE</code> (default), prints the likelihood ratio test
results in a nice format.</p></dd>

<dt><code>use_cached</code></dt><dd><p>If <code>TRUE</code> (default), use cached likelihood ratio
test results if any exist. Otherwise, new likelihood ratio tests will
be run, and these results will replace any in the cache.</p></dd>

<dt><code>...</code></dt><dd><p>Additional parameters to pass to the <code>control</code> list for
<code><a href='https://rdrr.io/r/stats/optim.html'>optim()</a></code> with <code>method = "L-BGFS-B"</code>. Note that <code>parscale</code> and
<code>fnscale</code> cannot be modified.</p></dd>

</dl><p></div></p>
<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Details</h4>
<p>Tests that each narrow-sense heritability parameter is zero
individually using a likelihood ratio test. See
<code><a href='../articles/linear_mixed_models.html'>vignette("linear_mixed_models")</a></code> for a detailed description of the
methods used. By default, results are cached in the <code>FamLMMFit</code>
object after the first call to avoid redundant optimizations on
subsequent calls.</p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Returns</h4>
<p>A <code>data.table</code> containing likelihood ratio test results,
invisibly.</p>
<p><hr>
<a id="method-clone"></a></p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Method <code>clone()</code></h3>
<p>The objects of this class are cloneable with this method.</p><h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Usage</h4>
<p><div class="r"></p><pre><span class='va'>FamLMMFit</span><span class='op'>$</span><span class='fu'>clone</span><span class='op'>(</span>deep <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre><p></div></p>

<h4 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Arguments</h4>
<p><div class="arguments"></p><dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p></dd>

</dl><p></div></p>



  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel D. Kinnamon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


